This function contains heat related functions
